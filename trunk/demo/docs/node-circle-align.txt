Алгоритм выравнивания вершин направленного графа с выявлением центров скоплений.

Задача. Выровнять вершины таким образом, чтобы вершины, в которые входит >= 2 дуг являлись центром группы их других вершин (являющихся ее антецедентами). Такие группы вершин должны быть расположены в вершинах квадратной сетки.

Решение.

1. Выделим вершины, в которые входит хоть одна дуга
2. Отсортируем по возрастанию
3. Пройдя по массиву с конца в начало применим алгоритм выравнивания группы вершин с одним центром. Вершины, для которых в этом процессе заданы координаты, помечаем. Если она была уже помечена, то оставляем ее координаты неизменными.